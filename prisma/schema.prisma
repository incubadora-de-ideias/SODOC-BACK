generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model auditoria {
  id                  String          @id
  id_usuario          String
  id_etapa            String
  id_documento        String
  id_versao_documento String
  documento           documento       @relation(fields: [id_documento], references: [id], map: "Auditoria_id_documento_fkey")
  etapa               etapa           @relation(fields: [id_etapa], references: [id], map: "Auditoria_id_etapa_fkey")
  usuario             usuario         @relation(fields: [id_usuario], references: [id], map: "Auditoria_id_usuario_fkey")
  versaodocumento     versaodocumento @relation(fields: [id_versao_documento], references: [id], map: "Auditoria_id_versao_documento_fkey")

  @@index([id_documento], map: "Auditoria_id_documento_fkey")
  @@index([id_etapa], map: "Auditoria_id_etapa_fkey")
  @@index([id_usuario], map: "Auditoria_id_usuario_fkey")
  @@index([id_versao_documento], map: "Auditoria_id_versao_documento_fkey")
}

model documento {
  id              String            @id
  nome            String
  descricao       String?
  caminho         String
  id_usuario      String
  auditoria       auditoria[]
  usuario         usuario           @relation(fields: [id_usuario], references: [id], map: "Documento_id_usuario_fkey")
  permissao       permissao[]
  versaodocumento versaodocumento[]

  @@index([id_usuario], map: "Documento_id_usuario_fkey")
}

model etapa {
  id                     String         @id
  nome                   String
  descricao              String?
  id_workflow            String
  estado                 String
  id_usuario_responsavel String
  auditoria              auditoria[]
  workflow               workflow       @relation(fields: [id_workflow], references: [id], map: "Etapa_id_workflow_fkey")
  usuarioetapa           usuarioetapa[]

  @@index([id_workflow], map: "Etapa_id_workflow_fkey")
}

model grupo {
  id           String         @id
  nome         String
  descricao    String?
  grupousuario grupousuario[]
  permissao    permissao[]
}

model grupousuario {
  id         String  @id
  id_usuario String
  id_grupo   String
  grupo      grupo   @relation(fields: [id_grupo], references: [id], map: "GrupoUsuario_id_grupo_fkey")
  usuario    usuario @relation(fields: [id_usuario], references: [id], map: "GrupoUsuario_id_usuario_fkey")

  @@index([id_grupo], map: "GrupoUsuario_id_grupo_fkey")
  @@index([id_usuario], map: "GrupoUsuario_id_usuario_fkey")
}

model notificacao {
  id         String  @id
  id_usuario String
  mensagem   String
  usuario    usuario @relation(fields: [id_usuario], references: [id], map: "Notificacao_id_usuario_fkey")

  @@index([id_usuario], map: "Notificacao_id_usuario_fkey")
}

model permissao {
  id                String        @id
  id_documento      String
  id_grupo          String?
  id_usuario        String?
  id_tipo_permissao String
  documento         documento     @relation(fields: [id_documento], references: [id], map: "Permissao_id_documento_fkey")
  grupo             grupo?        @relation(fields: [id_grupo], references: [id], map: "Permissao_id_grupo_fkey")
  tipopermissao     tipopermissao @relation(fields: [id_tipo_permissao], references: [id], map: "Permissao_id_tipo_permissao_fkey")
  usuario           usuario?      @relation(fields: [id_usuario], references: [id], map: "Permissao_id_usuario_fkey")

  @@index([id_documento], map: "Permissao_id_documento_fkey")
  @@index([id_grupo], map: "Permissao_id_grupo_fkey")
  @@index([id_tipo_permissao], map: "Permissao_id_tipo_permissao_fkey")
  @@index([id_usuario], map: "Permissao_id_usuario_fkey")
}

model tipopermissao {
  id        String      @id
  tipo      String
  permissao permissao[]
}

model tipousuario {
  id      String    @id
  tipo    String
  usuario usuario[]
}

model usuario {
  id              String            @id
  nome            String
  telefone        String?
  email           String?
  n_bi            String?
  password        String
  id_tipo_usuario String
  auditoria       auditoria[]
  documento       documento[]
  grupousuario    grupousuario[]
  notificacao     notificacao[]
  permissao       permissao[]
  tipousuario     tipousuario       @relation(fields: [id_tipo_usuario], references: [id], map: "Usuario_id_tipo_usuario_fkey")
  usuarioetapa    usuarioetapa[]
  versaodocumento versaodocumento[]
  workflow        workflow[]

  @@index([id_tipo_usuario], map: "Usuario_id_tipo_usuario_fkey")
}

model usuarioetapa {
  id         String  @id
  id_usuario String
  id_etapa   String
  etapa      etapa   @relation(fields: [id_etapa], references: [id], map: "UsuarioEtapa_id_etapa_fkey")
  usuario    usuario @relation(fields: [id_usuario], references: [id], map: "UsuarioEtapa_id_usuario_fkey")

  @@index([id_etapa], map: "UsuarioEtapa_id_etapa_fkey")
  @@index([id_usuario], map: "UsuarioEtapa_id_usuario_fkey")
}

model versaodocumento {
  id           String      @id
  id_documento String
  id_usuario   String
  caminho      String
  n_versao     Int
  auditoria    auditoria[]
  documento    documento   @relation(fields: [id_documento], references: [id], map: "VersaoDocumento_id_documento_fkey")
  usuario      usuario     @relation(fields: [id_usuario], references: [id], map: "VersaoDocumento_id_usuario_fkey")

  @@index([id_documento], map: "VersaoDocumento_id_documento_fkey")
  @@index([id_usuario], map: "VersaoDocumento_id_usuario_fkey")
}

model workflow {
  id         String  @id
  nome       String
  descricao  String?
  id_usuario String
  etapa      etapa[]
  usuario    usuario @relation(fields: [id_usuario], references: [id], map: "Workflow_id_usuario_fkey")

  @@index([id_usuario], map: "Workflow_id_usuario_fkey")
}
